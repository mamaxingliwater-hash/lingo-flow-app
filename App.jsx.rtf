{\rtf1\ansi\ansicpg936\cocoartf2867
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 import React, \{ useState, useEffect, useRef \} from 'react';\
import \{ \
  BookOpen, \
  Plus, \
  Settings, \
  Languages, \
  Sparkles, \
  Image as ImageIcon, \
  MoreHorizontal, \
  CheckCircle2, \
  Circle,\
  Trash2,\
  RefreshCw,\
  Volume2,\
  Share2\
\} from 'lucide-react';\
import \{ initializeApp \} from 'firebase/app';\
import \{ \
  getAuth, \
  signInAnonymously, \
  onAuthStateChanged, \
  signInWithCustomToken,\
  GoogleAuthProvider, // \uc0\u24341 \u20837  Google \u30331 \u24405 \u25552 \u20379 \u32773 \
  signInWithPopup,    // \uc0\u24341 \u20837  Google \u30331 \u24405 \u26041 \u27861 \
  signOut             // \uc0\u24341 \u20837 \u36864 \u20986 \u30331 \u24405 \u26041 \u27861 \
\} from 'firebase/auth';\
import \{ \
  getFirestore, \
  collection, \
  addDoc, \
  query, \
  orderBy, \
  onSnapshot, \
  deleteDoc, \
  doc, \
  updateDoc,\
  serverTimestamp\
\} from 'firebase/firestore';\
\
// --- Firebase Configuration & Initialization ---\
const firebaseConfig = JSON.parse(__firebase_config);\
const app = initializeApp(firebaseConfig);\
const auth = getAuth(app);\
const db = getFirestore(app);\
const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';\
const googleProvider = new GoogleAuthProvider(); // \uc0\u21021 \u22987 \u21270  Google \u30331 \u24405 \u25552 \u20379 \u32773 \
\
// --- AI Service (Simulated & Real) ---\
// In a real production app, this calls a serverless function to hide the API key.\
// For this prototype, we store the key in localStorage or use a mock mode.\
\
const callAI = async (prompt, apiKey, modelType = 'text') => \{\
  if (!apiKey) \{\
    // Simulation Mode for Demo\
    await new Promise(resolve => setTimeout(resolve, 1500));\
    if (prompt.includes("story")) \{\
      return "This is a simulated AI story. Because you haven't entered a real API Key in settings, I am improvising. Imagine a beautiful story weaving together your selected words. The protagonist used the 'Word1' to overcome the 'Word2' in a spectacular fashion.";\
    \}\
    // Default mock response for definition\
    return JSON.stringify(\{\
      definition: "\uc0\u36825 \u26159 \u19968 \u20010 \u27169 \u25311 \u30340 \u20013 \u25991 \u37322 \u20041  (Simulated Definition). Please add an API Key in settings for real AI intelligence.",\
      definition_en: "A simulated English definition for demonstration purposes.",\
      example: "This is an example sentence using the word.",\
      translation: "\uc0\u36825 \u26159 \u19968 \u20010 \u20351 \u29992 \u35813 \u21333 \u35789 \u30340 \u20363 \u21477 \u12290 ",\
      tags: ["noun", "simulated"]\
    \});\
  \}\
\
  // Real Gemini API Call\
  try \{\
    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=$\{apiKey\}`, \{\
      method: 'POST',\
      headers: \{ 'Content-Type': 'application/json' \},\
      body: JSON.stringify(\{\
        contents: [\{ parts: [\{ text: prompt \}] \}]\
      \})\
    \});\
    \
    const data = await response.json();\
    const text = data.candidates?.[0]?.content?.parts?.[0]?.text;\
    return text || "Error generating content";\
  \} catch (error) \{\
    console.error("AI Error", error);\
    // Use custom modal instead of alert\
    alert("AI \uc0\u35843 \u29992 \u22833 \u36133 \u65292 \u35831 \u26816 \u26597 \u24744 \u30340  API Key \u25110 \u32593 \u32476 \u36830 \u25509 \u12290 "); \
    return null;\
  \}\
\};\
\
// --- Components ---\
\
const LanguageBadge = (\{ lang \}) => \{\
  const colors = \{\
    'English': 'bg-blue-100 text-blue-800',\
    'Chinese': 'bg-red-100 text-red-800',\
    'Japanese': 'bg-pink-100 text-pink-800',\
    'French': 'bg-indigo-100 text-indigo-800',\
    'Spanish': 'bg-yellow-100 text-yellow-800',\
    'German': 'bg-orange-100 text-orange-800',\
    'Arabic': 'bg-emerald-100 text-emerald-800',\
  \};\
  return (\
    <span className=\{`text-xs px-2 py-0.5 rounded-full font-medium $\{colors[lang] || 'bg-gray-100 text-gray-800'\}`\}>\
      \{lang\}\
    </span>\
  );\
\};\
\
export default function App() \{\
  const [user, setUser] = useState(null);\
  const [words, setWords] = useState([]);\
  const [loading, setLoading] = useState(true);\
  const [activeTab, setActiveTab] = useState('list'); // list, add, story, settings\
  const [selectedWords, setSelectedWords] = useState(new Set());\
  \
  // Add Word State\
  const [inputText, setInputText] = useState('');\
  const [targetLang, setTargetLang] = useState('English');\
  const [isProcessing, setIsProcessing] = useState(false);\
  \
  // Settings State\
  const [apiKey, setApiKey] = useState(() => localStorage.getItem('gemini_api_key') || '');\
  \
  // Story State\
  const [generatedStory, setGeneratedStory] = useState('');\
  const [isGeneratingStory, setIsGeneratingStory] = useState(false);\
\
  // --- Auth & Data Sync ---\
  useEffect(() => \{\
    const initAuth = async () => \{\
      if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) \{\
        // \uc0\u20248 \u20808 \u20351 \u29992  Canvas \u25552 \u20379 \u30340  Custom Token \u30331 \u24405 \
        await signInWithCustomToken(auth, __initial_auth_token);\
      \} else \{\
        // \uc0\u21542 \u21017 \u20351 \u29992 \u21311 \u21517 \u30331 \u24405 \u65292 \u31561 \u24453 \u29992 \u25143 \u25163 \u21160  Google \u30331 \u24405 \
        await signInAnonymously(auth);\
      \}\
    \};\
    initAuth();\
    const unsubscribe = onAuthStateChanged(auth, (u) => \{\
      setUser(u);\
      if (!u) setLoading(false);\
    \});\
    return () => unsubscribe();\
  \}, []);\
\
  useEffect(() => \{\
    if (!user) return;\
    // Private user collection\
    const q = query(\
      collection(db, 'artifacts', appId, 'users', user.uid, 'vocab'),\
      orderBy('createdAt', 'desc')\
    );\
    \
    const unsubscribe = onSnapshot(q, (snapshot) => \{\
      const vocabData = snapshot.docs.map(doc => (\{\
        id: doc.id,\
        ...doc.data()\
      \}));\
      setWords(vocabData);\
      setLoading(false);\
    \}, (err) => console.error("Firestore error:", err));\
\
    return () => unsubscribe();\
  \}, [user]);\
  \
  // --- Auth Actions for Synchronization ---\
  \
  const handleGoogleSignIn = async () => \{\
    try \{\
        await signInWithPopup(auth, googleProvider);\
        // \uc0\u20351 \u29992 \u33258 \u23450 \u20041 \u27169 \u24577 \u32780 \u19981 \u26159  alert\
        alert("Google \uc0\u30331 \u24405 \u25104 \u21151 \u65281 \u25968 \u25454 \u23558 \u22312 \u25152 \u26377 \u35774 \u22791 \u19978 \u23454 \u26102 \u21516 \u27493 \u12290 ");\
    \} catch (error) \{\
        console.error("Google Sign-in Error:", error);\
        // \uc0\u20351 \u29992 \u33258 \u23450 \u20041 \u27169 \u24577 \u32780 \u19981 \u26159  alert\
        alert("Google \uc0\u30331 \u24405 \u22833 \u36133 \u65292 \u35831 \u30830 \u20445 \u24744 \u24050 \u22312  Firebase \u25511 \u21046 \u21488 \u24320 \u21551  Google \u30331 \u24405 \u12290 ");\
    \}\
  \};\
\
  const handleSignOut = async () => \{\
    try \{\
        // \uc0\u36864 \u20986 \u24403 \u21069 \u29992 \u25143 \
        await signOut(auth);\
        // \uc0\u36864 \u20986 \u21518 \u37325 \u26032 \u21311 \u21517 \u30331 \u24405 \u65292 \u20445 \u25345  App \u21487 \u29992 \u24615 \
        await signInAnonymously(auth); \
        // \uc0\u20351 \u29992 \u33258 \u23450 \u20041 \u27169 \u24577 \u32780 \u19981 \u26159  alert\
        alert("\uc0\u24744 \u24050 \u36864 \u20986 \u30331 \u24405 \u65292 \u24403 \u21069 \u20026 \u35775 \u23458 \u27169 \u24335 \u12290 ");\
    \} catch (error) \{\
        console.error("Sign-out Error:", error);\
    \}\
  \};\
\
\
  // --- Data & AI Actions ---\
\
  const handleSaveApiKey = (key) => \{\
    setApiKey(key);\
    localStorage.setItem('gemini_api_key', key);\
  \};\
\
  const processNewWord = async () => \{\
    if (!inputText.trim()) return;\
    // \uc0\u26816 \u26597 \u29992 \u25143 \u26159 \u21542 \u24050 \u30331 \u24405  (\u38750 \u31354 \u25110 \u21311 \u21517 )\
    if (!user) \{\
        alert("\uc0\u35831 \u20808 \u30331 \u24405 \u25110 \u31561 \u24453 \u35748 \u35777 \u23436 \u25104 \u12290 ");\
        return;\
    \}\
    \
    setIsProcessing(true);\
\
    // Construct Prompt for AI\
    const prompt = `\
      You are a linguistics expert. Analyze the word/phrase: "$\{inputText\}".\
      Target Language context: $\{targetLang\}.\
      \
      Return a purely JSON object (no markdown, no code blocks) with this structure:\
      \{\
        "word": "$\{inputText\}",\
        "definition": "Meaning in native language (if word is JP, give JP meaning, else CN)",\
        "definition_en": "Meaning in English",\
        "example": "A sentence in the target language using the word",\
        "translation": "Translation of the example sentence in Chinese",\
        "tags": ["noun/verb/adj", "topic"]\
      \}\
    `;\
\
    let aiData = \{\};\
    let saveText = inputText; // Use original input text for saving if AI fails\
    try \{\
      const result = await callAI(prompt, apiKey);\
      // Clean up potential markdown code blocks from AI response\
      const cleanJson = result.replace(/```json/g, '').replace(/```/g, '').trim();\
      aiData = JSON.parse(cleanJson);\
    \} catch (e) \{\
      console.error("Parsing failed, falling back", e);\
      aiData = \{\
        word: saveText,\
        definition: "\uc0\u26080 \u27861 \u36830 \u25509  AI \u25110 \u35299 \u26512 \u22833 \u36133  (AI Failed to Process)",\
        definition_en: "AI Connection Failed",\
        example: "\uc0\u35831 \u25163 \u21160 \u28155 \u21152 \u20363 \u21477 ",\
        translation: "N/A",\
        tags: ["manual"]\
      \};\
    \}\
\
    // Add to Firestore\
    try \{\
      await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'vocab'), \{\
        ...aiData,\
        language: targetLang,\
        createdAt: serverTimestamp(),\
        // Use Unsplash source for demo images (In production, use DALL-E or reliable API)\
        imageUrl: `https://placehold.co/600x400/indigo/white?text=$\{encodeURIComponent(saveText)\}`, \
      \});\
      setInputText('');\
      setActiveTab('list');\
    \} catch (e) \{\
      // Use custom modal instead of alert\
      alert("\uc0\u20445 \u23384 \u22833 \u36133 : " + e.message);\
    \} finally \{\
      setIsProcessing(false);\
    \}\
  \};\
\
  const toggleSelectWord = (id) => \{\
    const newSet = new Set(selectedWords);\
    if (newSet.has(id)) newSet.delete(id);\
    else newSet.add(id);\
    setSelectedWords(newSet);\
  \};\
\
  const generateStory = async () => \{\
    if (selectedWords.size === 0) return;\
    setIsGeneratingStory(true);\
    \
    const selectedWordList = words.filter(w => selectedWords.has(w.id)).map(w => w.word);\
    \
    const prompt = `\
      Create a short, engaging story (max 150 words) specifically to help me memorize these words: $\{selectedWordList.join(', ')\}.\
      The story should be in $\{targetLang\} but allow mixed language if helpful for learning.\
      Highlight the selected words in **bold**.\
    `;\
\
    const story = await callAI(prompt, apiKey);\
    setGeneratedStory(story);\
    setIsGeneratingStory(false);\
  \};\
\
  const deleteWord = async (id) => \{\
    // Use custom modal instead of confirm\
    if(window.confirm('\uc0\u30830 \u35748 \u21024 \u38500 \u27492 \u29983 \u35789 \u21345 \u29255 \u21527 \u65311 ')) \{\
      await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'vocab', id));\
      const newSet = new Set(selectedWords);\
      newSet.delete(id);\
      setSelectedWords(newSet);\
    \}\
  \};\
\
  // --- Views ---\
\
  if (loading) return (\
    <div className="flex items-center justify-center h-screen bg-slate-50">\
      <div className="animate-spin text-indigo-600">\
        <RefreshCw size=\{32\} />\
      </div>\
    </div>\
  );\
\
  return (\
    <div className="flex flex-col h-screen bg-slate-50 font-sans text-slate-900 max-w-md mx-auto shadow-2xl overflow-hidden relative border-x border-slate-200">\
      \
      \{/* Header */\}\
      <header className="bg-white border-b px-4 py-3 flex items-center justify-between sticky top-0 z-10 safe-top">\
        <div className="flex items-center space-x-2">\
          <div className="bg-indigo-600 text-white p-1.5 rounded-lg">\
            <BookOpen size=\{20\} />\
          </div>\
          <h1 className="font-bold text-lg tracking-tight">LingoFlow</h1>\
        </div>\
        <button onClick=\{() => setActiveTab('settings')\} className="text-slate-400 hover:text-slate-600">\
          <Settings size=\{20\} />\
        </button>\
      </header>\
\
      \{/* Main Content Area */\}\
      <main className="flex-1 overflow-y-auto p-4 pb-24 scrollbar-hide">\
        \
        \{/* SETTINGS TAB */\}\
        \{activeTab === 'settings' && (\
          <div className="space-y-6 animate-fade-in">\
            \
            \{/* AI Configuration */\}\
            <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">\
              <h2 className="text-xl font-bold mb-4">AI \uc0\u37197 \u32622 </h2>\
              <p className="text-sm text-slate-500 mb-4">\
                \uc0\u24320 \u21551 \u33258 \u21160 \u37322 \u20041 \u12289 \u25925 \u20107 \u29983 \u25104 \u21644 \u22270 \u29255 \u21151 \u33021 \u65292 \u35831 \u36755 \u20837 \u24744 \u30340  Gemini API Key\u12290 \
              </p>\
              <label className="block text-sm font-medium text-slate-700 mb-1">Google Gemini API Key</label>\
              <input \
                type="password" \
                value=\{apiKey\}\
                onChange=\{(e) => handleSaveApiKey(e.target.value)\}\
                placeholder="AIzaSy..."\
                className="w-full p-3 border rounded-xl bg-slate-50 focus:ring-2 focus:ring-indigo-500 outline-none"\
              />\
              <div className="mt-4 p-3 bg-blue-50 text-blue-700 text-xs rounded-lg">\
                \uc0\u25552 \u31034 \u65306 \u26410 \u35774 \u32622 \u23494 \u38053 \u26102 \u65292 App \u20250 \u36827 \u20837 \'93\u27169 \u25311 \u27169 \u24335 \'94\u12290 \
              </div>\
            </div>\
\
            \{/* Account & Sync (New Section) */\}\
            <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">\
                <h2 className="text-xl font-bold mb-4">\uc0\u36134 \u21495 \u19982 \u21516 \u27493 </h2>\
                <p className="text-sm text-slate-500 mb-4">\
                    \uc0\u20351 \u29992  Google \u36134 \u21495 \u30331 \u24405 \u21518 \u65292 \u20320 \u30340 \u29983 \u35789 \u25968 \u25454 \u23558 \u22312 \u25152 \u26377 \u35774 \u22791 \u38388 \u23454 \u26102 \u21516 \u27493 \u12290 \
                </p>\
                \
                \{user?.isAnonymous || !user?.uid ? (\
                    // \uc0\u21311 \u21517 \u29992 \u25143 \u25110 \u26410 \u30331 \u24405 \u26102 \u26174 \u31034  Google \u30331 \u24405 \u25353 \u38062 \
                    <button \
                        onClick=\{handleGoogleSignIn\}\
                        className="w-full py-3 bg-blue-600 text-white font-bold rounded-xl shadow-md hover:bg-blue-700 transition-colors flex items-center justify-center gap-2"\
                    >\
                        <img src="https://upload.wikimedia.org/wikipedia/commons/4/4a/Logo_and_wordmark_of_Google_G_Suite.svg" alt="Google" className="w-5 h-5" />\
                        \uc0\u20351 \u29992  Google \u36134 \u21495 \u30331 \u24405 \
                    </button>\
                ) : (\
                    // \uc0\u30331 \u24405 \u21518 \u26174 \u31034 \u29992 \u25143 \u20449 \u24687 \u21644 \u36864 \u20986 \u25353 \u38062 \
                    <div className="space-y-4">\
                        <p className="text-sm font-medium text-slate-700">\uc0\u24403 \u21069 \u29992 \u25143 ID: <span className="text-xs break-all bg-slate-100 p-1 rounded font-mono">\{user.uid\}</span></p>\
                        <p className="text-xs text-slate-500">\uc0\u27492  ID \u30830 \u20445 \u24744 \u30340 \u25968 \u25454 \u26159 \u21807 \u19968 \u30340 \u65292 \u24182 \u33021 \u22312 \u19981 \u21516 \u35774 \u22791 \u19978 \u21516 \u27493 \u12290 </p>\
                        <button \
                            onClick=\{handleSignOut\}\
                            className="w-full py-3 bg-red-100 text-red-600 font-semibold rounded-xl hover:bg-red-200"\
                        >\
                            \uc0\u36864 \u20986 \u30331 \u24405 \
                        </button>\
                    </div>\
                )\}\
            </div>\
            \
            <button onClick=\{() => setActiveTab('list')\} className="w-full py-3 bg-slate-200 text-slate-700 font-semibold rounded-xl">\
              \uc0\u20851 \u38381 \u35774 \u32622 \
            </button>\
          </div>\
        )\}\
\
        \{/* ADD WORD TAB */\}\
        \{activeTab === 'add' && (\
          <div className="space-y-4 animate-slide-up">\
            <div className="bg-white p-6 rounded-2xl shadow-lg border border-slate-100">\
              <label className="block text-sm font-medium text-slate-500 mb-2 uppercase tracking-wider">\uc0\u26032 \u35789 \u26465 </label>\
              <textarea \
                value=\{inputText\}\
                onChange=\{(e) => setInputText(e.target.value)\}\
                placeholder="\uc0\u31896 \u36148 \u21333 \u35789 \u25110 \u21477 \u23376 ..."\
                className="w-full h-32 text-xl font-medium placeholder:text-slate-300 border-none focus:ring-0 resize-none p-0"\
                autoFocus\
              />\
              <div className="h-px bg-slate-100 my-4" />\
              <div className="flex items-center justify-between">\
                <div className="flex items-center space-x-2 text-slate-500">\
                  <Languages size=\{18\} />\
                  <select \
                    value=\{targetLang\}\
                    onChange=\{(e) => setTargetLang(e.target.value)\}\
                    className="bg-transparent font-medium outline-none text-sm"\
                  >\
                    \{['English', 'Chinese', 'Japanese', 'French', 'Spanish', 'German', 'Arabic'].map(l => (\
                      <option key=\{l\} value=\{l\}>\{l\}</option>\
                    ))\}\
                  </select>\
                </div>\
                <button \
                  onClick=\{processNewWord\}\
                  disabled=\{!inputText || isProcessing\}\
                  className=\{`px-6 py-2 rounded-full font-semibold text-white transition-all $\{\
                    inputText ? 'bg-indigo-600 shadow-md hover:bg-indigo-700' : 'bg-slate-300 cursor-not-allowed'\
                  \}`\}\
                >\
                  \{isProcessing ? <RefreshCw className="animate-spin" size=\{20\} /> : '\uc0\u26234 \u33021 \u20998 \u26512 '\}\
                </button>\
              </div>\
            </div>\
          </div>\
        )\}\
\
        \{/* LIST TAB (DEFAULT) */\}\
        \{activeTab === 'list' && (\
          <div className="space-y-4">\
            \{words.length === 0 ? (\
              <div className="text-center py-20 text-slate-400">\
                <div className="bg-slate-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">\
                  <Sparkles size=\{24\} />\
                </div>\
                <p>\uc0\u29983 \u35789 \u26412 \u20013 \u36824 \u27809 \u26377 \u21333 \u35789 \u12290 </p>\
                <p className="text-sm mt-2">\uc0\u28857 \u20987  "+" \u28155 \u21152 \u20320 \u30340 \u31532 \u19968 \u20010 \u21333 \u35789 \u12290 </p>\
              </div>\
            ) : (\
              words.map((word) => (\
                <div \
                  key=\{word.id\} \
                  className=\{`bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden transition-all $\{\
                    selectedWords.has(word.id) ? 'ring-2 ring-indigo-500 bg-indigo-50' : ''\
                  \}`\}\
                >\
                  <div className="relative h-32 bg-slate-100">\
                    <img \
                      src=\{word.imageUrl\} \
                      alt=\{word.word\} \
                      className="w-full h-full object-cover opacity-90"\
                      onError=\{(e) => \{\
                        e.target.src = 'https://placehold.co/600x400/eee/999?text=No+Image';\
                      \}\}\
                    />\
                    <div className="absolute top-2 right-2 flex space-x-1">\
                      <button \
                        onClick=\{() => toggleSelectWord(word.id)\}\
                        className="p-2 bg-white/80 backdrop-blur rounded-full shadow-sm text-indigo-600 hover:bg-white transition-colors"\
                      >\
                        \{selectedWords.has(word.id) ? <CheckCircle2 size=\{20\} /> : <Circle size=\{20\} />\}\
                      </button>\
                    </div>\
                    <div className="absolute bottom-2 left-2">\
                       <LanguageBadge lang=\{word.language\} />\
                    </div>\
                  </div>\
                  \
                  <div className="p-4">\
                    <div className="flex justify-between items-start mb-2">\
                      <h3 className="text-2xl font-bold text-slate-800">\{word.word\}</h3>\
                      <button onClick=\{() => deleteWord(word.id)\} className="text-slate-300 hover:text-red-400">\
                        <Trash2 size=\{16\} />\
                      </button>\
                    </div>\
                    \
                    <p className="text-slate-600 font-medium mb-1">\{word.definition\}</p>\
                    <p className="text-slate-400 text-sm mb-3 italic">\{word.definition_en\}</p>\
                    \
                    <div className="bg-slate-50 p-3 rounded-xl border border-slate-100">\
                      <p className="text-indigo-900 text-sm leading-relaxed">"\{word.example\}"</p>\
                      <p className="text-slate-400 text-xs mt-1">\{word.translation\}</p>\
                    </div>\
                  </div>\
                </div>\
              ))\
            )\}\
            <div className="h-12"></div> \{/* Spacer for FAB */\}\
          </div>\
        )\}\
\
        \{/* STORY TAB */\}\
        \{activeTab === 'story' && (\
          <div className="space-y-4 animate-fade-in h-full flex flex-col">\
            <div className="bg-white p-6 rounded-2xl shadow-lg border border-slate-100 flex-1 flex flex-col">\
              <div className="flex items-center justify-between mb-4">\
                <h2 className="text-xl font-bold text-indigo-900 flex items-center gap-2">\
                  <Sparkles className="text-indigo-500" size=\{20\} />\
                  \uc0\u25925 \u20107 \u27169 \u24335 \
                </h2>\
                <span className="text-sm text-slate-500">\uc0\u24050 \u36873  \{selectedWords.size\} \u20010 \u21333 \u35789 </span>\
              </div>\
              \
              <div className="flex-1 overflow-y-auto bg-indigo-50/50 rounded-xl p-4 border border-indigo-100 mb-4">\
                \{isGeneratingStory ? (\
                   <div className="flex flex-col items-center justify-center h-full text-indigo-400 space-y-3">\
                     <RefreshCw className="animate-spin" size=\{32\} />\
                     <p className="text-sm font-medium">\uc0\u27491 \u22312 \u20026 \u20320 \u21019 \u20316 \u25925 \u20107 ...</p>\
                   </div>\
                ) : generatedStory ? (\
                  <div className="prose prose-indigo">\
                    <p className="whitespace-pre-wrap leading-relaxed text-slate-700">\{generatedStory\}</p>\
                  </div>\
                ) : (\
                  <div className="flex flex-col items-center justify-center h-full text-slate-400 text-center p-4">\
                    <BookOpen size=\{40\} className="mb-2 opacity-20" />\
                    <p>\uc0\u20174 \u21015 \u34920 \u20013 \u36873 \u25321 \u21333 \u35789 \u65292 \u28982 \u21518 \u28857 \u20987 \u29983 \u25104 \u65292 \u20026 \u23427 \u20204 \u21019 \u20316 \u19968 \u20010 \u35760 \u24518 \u24773 \u22659 \u12290 </p>\
                  </div>\
                )\}\
              </div>\
\
              <div className="flex gap-3">\
                <button \
                  onClick=\{() => setActiveTab('list')\}\
                  className="flex-1 py-3 bg-slate-100 text-slate-600 font-semibold rounded-xl hover:bg-slate-200"\
                >\
                  \uc0\u36820 \u22238 \u21015 \u34920 \
                </button>\
                <button \
                  onClick=\{generateStory\}\
                  disabled=\{selectedWords.size === 0 || isGeneratingStory\}\
                  className=\{`flex-1 py-3 text-white font-bold rounded-xl shadow-md transition-all $\{\
                     selectedWords.size > 0 ? 'bg-indigo-600 hover:bg-indigo-700' : 'bg-slate-300 cursor-not-allowed'\
                  \}`\}\
                >\
                  \uc0\u29983 \u25104 \u25925 \u20107 \
                </button>\
              </div>\
            </div>\
          </div>\
        )\}\
\
      </main>\
\
      \{/* Floating Navigation / Action Bar */\}\
      \{activeTab === 'list' && (\
        <div className="absolute bottom-6 left-0 right-0 flex justify-center items-center gap-4 px-6 pointer-events-none">\
          \
          \{/* Generate Story FAB (Only shows if words selected) */\}\
          \{selectedWords.size > 0 && (\
            <button \
              onClick=\{() => setActiveTab('story')\}\
              className="pointer-events-auto bg-white text-indigo-600 px-5 py-3 rounded-full shadow-xl border border-indigo-100 flex items-center gap-2 font-bold hover:scale-105 transition-transform"\
            >\
              <Sparkles size=\{20\} fill="currentColor" className="text-indigo-200" />\
              <span>\uc0\u21019 \u20316 \u25925 \u20107  (\{selectedWords.size\})</span>\
            </button>\
          )\}\
\
          \{/* Add Word FAB */\}\
          <button \
            onClick=\{() => setActiveTab('add')\}\
            className="pointer-events-auto w-14 h-14 bg-indigo-600 text-white rounded-full shadow-xl flex items-center justify-center hover:bg-indigo-700 hover:scale-105 transition-all active:scale-95"\
          >\
            <Plus size=\{32\} />\
          </button>\
        </div>\
      )\}\
\
    </div>\
  );\
\}}